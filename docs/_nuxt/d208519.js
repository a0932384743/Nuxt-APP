(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{824:function(t,e,n){t.exports={}},837:function(t,e,n){"use strict";n(824)},855:function(t,e,n){"use strict";n.r(e);n(85);var o=n(93),r=(n(27),n(134),n(138),n(66),n(23),n(69),n(420),n(28),n(18),n(98),n(25),n(100),n(816)),c=n(16),l=function(){return l=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},l.apply(this,arguments)},d=function(t,e,n,o){return new(n||(n=Promise))((function(r,c){function l(t){try{f(o.next(t))}catch(t){c(t)}}function d(t){try{f(o.throw(t))}catch(t){c(t)}}function f(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(l,d)}f((o=o.apply(t,e||[])).next())}))},f=function(t,body){var e,n,o,g,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return g={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function c(c){return function(l){return function(c){if(e)throw new TypeError("Generator is already executing.");for(;g&&(g=0,c[0]&&(r=0)),r;)try{if(e=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,n=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){r=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(6===c[0]&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=body.call(t,r)}catch(t){c=[6,t],n=0}finally{e=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,l])}}},h=["transparent","limegreen","orange","red"],y=c.default.extend({name:"Alert",components:{DashboardWidget:r.default},layout:"DashboardLayout",data:function(){return{modalShow:!1,option:{grid:{bottom:"8%"},title:{text:""},tooltip:{trigger:"axis",axisPointer:{type:"cross",crossStyle:{color:"#999"}},valueFormatter:function(t){return"".concat(t," k")}},xAxis:{type:"category",data:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},yAxis:{type:"value",axisLabel:{formatter:function(t){return"".concat(t," k")}}},series:[]},dashboardList:[]}},computed:{loading:function(){return this.$store.getters["dashboard/getLoading"]},dataSource:function(){var t=this.$store.getters["dashboard/getIncomeStatics"],e={},n={type:"category",data:Object.keys(t).filter((function(e){return Object.keys(t[e]).length>0}))},o={type:"value",axisLabel:{formatter:function(t){return"".concat(t,"%")}}};return Object.keys(t).forEach((function(r){Object.keys(t[r]).forEach((function(c){e[c]||(e[c]={xAxis:n,yAxis:o,series:[{name:"bar",type:"bar",data:[],tooltip:{show:!1}},{name:c,type:"line",data:[],label:{show:!0,position:"top"}}]}),e[c].series[0].data.push(t[r][c]||0),e[c].series[1].data.push(t[r][c]||0)}))})),Object.keys(e).forEach((function(t){var o=e[t].series[0].data.reduce((function(t,e,n,o){return n>0&&e<o[n-1]&&t.push(n),t}),[]);e[t].series[0].markPoint={data:o.map((function(o,r){return{symbol:"path://M10 10 L20 30 L0 30 Z M10 15 L10 25 M10 35 L10 40",symbolSize:[30,40],itemStyle:{color:h[3]},name:t,value:e[t].series[0].data[r],xAxis:o,yAxis:e[t].series[0].data[r]/2,year:n.data[r]}}))},o.forEach((function(o){e[t].series[0].data[o]={value:e[t].series[0].data[o],name:t,year:n.data[o],itemStyle:{color:h[2]}}}))})),e},trend:function(){var t=0,e=this.$store.getters["dashboard/getIncomeStatics"],n={};return Object.keys(e).forEach((function(t){Object.keys(e[t]).forEach((function(o){n[o]||(n[o]={series:[{name:"bar",type:"bar",data:[],tooltip:{show:!1}}]}),n[o].series[0].data.push(e[t][o]||0)}))})),Object.keys(n).forEach((function(e){n[e].series[0].data.reduce((function(t,e,n,o){return n>0&&e<o[n-1]&&t.push(n),t}),[]).length>0&&t<3&&t++})),{color:h[t],stroke:t>0?h[t]:"white"}}},created:function(){this.onLoadDashboard(this.$route.path)},methods:{click:function(param){return d(this,void 0,void 0,(function(){var t;return f(this,(function(e){switch(e.label){case 0:return"object"!==Object(o.a)(param.data)?[3,2]:[4,Promise.all([this.$fire.database.ref("incomeMonthStatics/".concat(Number(param.data.year)-1,"/").concat(param.data.name)).once("value"),this.$fire.database.ref("incomeMonthStatics/".concat(param.data.year,"/").concat(param.data.name)).once("value"),this.$fire.database.ref("incomeMonthStatics/".concat(Number(param.data.year)+1,"/").concat(param.data.name)).once("value")])];case 1:t=e.sent(),this.option.title.text=param.data.name,this.option.series=t.map((function(t,e){return{type:"bar",showBackground:!0,backgroundStyle:{color:"rgba(220, 220, 220, 0.8)"},name:param.data.year-1+e,data:t.val()||[]}})),this.modalShow=!0,e.label=2;case 2:return[2]}}))}))},onLoadDashboard:function(){return d(this,arguments,void 0,(function(path){var t=this;return void 0===path&&(path=""),f(this,(function(e){return this.$fire.database.ref("widgets".concat(path)).once("value",(function(e){var data=e.val();t.dashboardList=data.filter((function(t){return t})).map((function(t,e){return l(l({},t),{i:e})}))})),[2]}))}))}}}),m=y,v=(n(837),n(124)),component=Object(v.a)(m,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"h-100"},[e("b-modal",{attrs:{"ok-only":"","ok-title":t.$t("close"),"ok-variant":"info"},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[t.modalShow?e("v-chart",{staticClass:"w-100",attrs:{options:t.option,autoresize:""}}):t._e()],1),t._v(" "),e("div",{staticClass:"d-flex px-2 text-white",staticStyle:{gap:"1rem"}},[e("div",[e("font-awesome-icon",{style:t.trend,attrs:{icon:"circle","stroke-width":"20"}}),t._v("\n      預警\n    ")],1)]),t._v(" "),e("grid-layout",{attrs:{show:!t.loading,layout:t.dashboardList,"col-num":3,"row-num":3,"row-height":300,"is-draggable":"","is-resizable":"","vertical-compact":"","use-css-transforms":""}},[t._l(t.dashboardList,(function(n){return e("dashboard-widget",{key:n.name,attrs:{item:n,"data-source":t.dataSource},on:{click:t.click}})})),t._v(" "),e("grid-item",{attrs:{x:2,y:1,w:1,h:1,i:6,"is-draggable":!1}},[e("b-card",{staticClass:"bg-transparent h-100",attrs:{"text-variant":"white","header-class":"py-1 px-2","body-class":"p-2 overflow-auto","border-variant":"secondary"},scopedSlots:t._u([{key:"header",fn:function(){return[e("h5",{staticClass:"text-white"},[t._v("\n            "+t._s(t.$t("income.text.1"))+":\n          ")])]},proxy:!0}])},[t._v(" "),e("div",{staticClass:"d-flex flex-column bg-white text-dark py-2 px-1",staticStyle:{"font-size":"1rem",gap:"0.8rem"}},[e("div",{staticClass:"d-flex align-content-center",staticStyle:{gap:"0.5rem"}},[e("font-awesome-icon",{attrs:{icon:"circle",color:"limegreen"}}),t._v("良好:無指標達2年衰退\n          ")],1),t._v(" "),e("div",{staticClass:"d-flex align-content-center",staticStyle:{gap:"0.5rem"}},[e("font-awesome-icon",{attrs:{icon:"circle",color:"yellow"}}),t._v("尚可:1~2個指標達兩年衰退\n          ")],1),t._v(" "),e("div",{staticClass:"d-flex align-content-center",staticStyle:{gap:"0.5rem"}},[e("font-awesome-icon",{attrs:{icon:"circle",color:"red"}}),t._v("警戒:半數以上指標達兩年衰退\n          ")],1)])])],1)],2)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{DashboardWidget:n(816).default})}}]);